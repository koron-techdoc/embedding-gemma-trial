# 派生課題: 城のクラスタリング

日本に現存する12の城を、所在する都道府県へクラスタリングする。

使用するモデルは学習してない生のモデル、
完全な自治体名での学習したモデル、
特別区の市名を除いた名称で学習したモデル。

## 結果

結果の列の意味

    名称    正解数/1    回答#1      回答#2      真実

### 学習してないモデル

未学習だと以下の通り accuracy は 1/12 で 0.083 となった。

正解したのは高知城のみ。
城名が所在県名と一致しているので当然だろう。

```console
$ ./cluster_local_govs.py -l ./japan_castles.tsv -m google/embeddinggemma-300m
弘前城      0/1         広島県      埼玉県      青森県
松本城      0/1         埼玉県      石川県      長野県
丸岡城      0/1         埼玉県      石川県      福井県
犬山城      0/1         埼玉県      山口県      愛知県
彦根城      0/1         埼玉県      京都府      滋賀県
姫路城      0/1         埼玉県      宮城県      兵庫県
松江城      0/1         埼玉県      石川県      島根県
備中松山城  0/1         埼玉県      山梨県      岡山県
丸亀城      0/1         埼玉県      石川県      香川県
伊予松山城  0/1         宮城県      山形県      愛媛県
宇和島城    0/1         島根県      京都府      愛媛県
高知城      1/1         高知県      広島県      高知県

accuracy: 0.08333333333333333
```

### 完全な自治体名での学習したモデル

学習後のクラスタリング結果は以下の通り
accuracy は 10/12 で 0.833 となった。
丸岡城と犬山城を間違えた。

概ね城名と同名の地方自治体があるために良好な結果になったと考えられる。

備中と伊予の松山城を正しく分類できていることから、
学習により備中と伊予という旧国名の概念が再現されている可能性が考えられる。

```console
$ ./cluster_local_govs.py -l ./japan_castles.tsv -m ./trained-lgov-full/checkpoint-100/
弘前城      1/1         青森県      岩手県      青森県
松本城      1/1         長野県      群馬県      長野県
丸岡城      0/1         群馬県      京都府      福井県
犬山城      0/1         京都府      香川県      愛知県
彦根城      1/1         滋賀県      群馬県      滋賀県
姫路城      1/1         兵庫県      大分県      兵庫県
松江城      1/1         島根県      愛媛県      島根県
備中松山城  1/1         岡山県      広島県      岡山県
丸亀城      1/1         香川県      京都府      香川県
伊予松山城  1/1         愛媛県      三重県      愛媛県
宇和島城    1/1         愛媛県      徳島県      愛媛県
高知城      1/1         高知県      宮崎県      高知県

accuracy: 0.8333333333333334
```

### 特別区の市名を除いた名称で学習したモデル

特別区の市名を除いたデータで学習したモデルでのクラスタリングでは、
accuracy は 11/12 で 0.917 となった。
犬山城で正解し、丸岡上は不正解のまま。

犬山は同名の市が存在するにも関わらず
前のモデルでは正しく推定できず、
こちらでは正しく推定できている理由は不明。

```console
$ ./cluster_local_govs.py -l ./japan_castles.tsv -m ./trained-lgov-partial/checkpoint-100/
弘前城      1/1         青森県      秋田県      青森県
松本城      1/1         長野県      山梨県      長野県
丸岡城      0/1         秋田県      宮城県      福井県
犬山城      1/1         愛知県      滋賀県      愛知県
彦根城      1/1         滋賀県      栃木県      滋賀県
姫路城      1/1         兵庫県      大分県      兵庫県
松江城      1/1         島根県      熊本県      島根県
備中松山城  1/1         岡山県      熊本県      岡山県
丸亀城      1/1         香川県      愛媛県      香川県
伊予松山城  1/1         愛媛県      三重県      愛媛県
宇和島城    1/1         愛媛県      島根県      愛媛県
高知城      1/1         高知県      宮崎県      高知県

accuracy: 0.9166666666666666
```

## 旧国名
